{
"version":3,
"file":"goog.net.bulkloader.js",
"lineCount":69,
"mappings":"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",
"sources":["goog/net/bulkloader.js"],
"sourcesContent":["/**\n * @license\n * Copyright The Closure Library Authors.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Loads a list of URIs in bulk. All requests must be a success\n * in order for the load to be considered a success.\n */\n\ngoog.provide('goog.net.BulkLoader');\n\ngoog.require('goog.events.Event');\ngoog.require('goog.events.EventHandler');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.log');\ngoog.require('goog.net.BulkLoaderHelper');\ngoog.require('goog.net.EventType');\ngoog.require('goog.net.XhrIo');\ngoog.requireType('goog.Uri');\n\n\n\n/**\n * Class used to load multiple URIs.\n * @param {Array<string|goog.Uri>} uris The URIs to load.\n * @constructor\n * @extends {goog.events.EventTarget}\n * @final\n */\ngoog.net.BulkLoader = function(uris) {\n  'use strict';\n  goog.events.EventTarget.call(this);\n\n  /**\n   * The bulk loader helper.\n   * @type {goog.net.BulkLoaderHelper}\n   * @private\n   */\n  this.helper_ = new goog.net.BulkLoaderHelper(uris);\n\n  /**\n   * The handler for managing events.\n   * @type {goog.events.EventHandler<!goog.net.BulkLoader>}\n   * @private\n   */\n  this.eventHandler_ = new goog.events.EventHandler(this);\n};\ngoog.inherits(goog.net.BulkLoader, goog.events.EventTarget);\n\n\n/**\n * A logger.\n * @type {goog.log.Logger}\n * @private\n */\ngoog.net.BulkLoader.prototype.logger_ =\n    goog.log.getLogger('goog.net.BulkLoader');\n\n\n/**\n * Gets the response texts, in order.\n * @return {Array<string>} The response texts.\n */\ngoog.net.BulkLoader.prototype.getResponseTexts = function() {\n  'use strict';\n  return this.helper_.getResponseTexts();\n};\n\n\n/**\n * Gets the request Uris.\n * @return {Array<string>} The request URIs, in order.\n */\ngoog.net.BulkLoader.prototype.getRequestUris = function() {\n  'use strict';\n  return this.helper_.getUris();\n};\n\n\n/**\n * Starts the process of loading the URIs.\n */\ngoog.net.BulkLoader.prototype.load = function() {\n  'use strict';\n  const eventHandler = this.eventHandler_;\n  const uris = this.helper_.getUris();\n  goog.log.info(\n      this.logger_, 'Starting load of code with ' + uris.length + ' uris.');\n\n  for (let i = 0; i < uris.length; i++) {\n    const xhrIo = new goog.net.XhrIo();\n    eventHandler.listen(\n        xhrIo, goog.net.EventType.COMPLETE,\n        goog.bind(this.handleEvent_, this, i));\n\n    xhrIo.send(uris[i]);\n  }\n};\n\n\n/**\n * Handles all events fired by the XhrManager.\n * @param {number} id The id of the request.\n * @param {goog.events.Event} e The event.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleEvent_ = function(id, e) {\n  'use strict';\n  goog.log.info(\n      this.logger_,\n      'Received event \"' + e.type + '\" for id ' + id + ' with uri ' +\n          this.helper_.getUri(id));\n  const xhrIo = /** @type {goog.net.XhrIo} */ (e.target);\n  if (xhrIo.isSuccess()) {\n    this.handleSuccess_(id, xhrIo);\n  } else {\n    this.handleError_(id, xhrIo);\n  }\n};\n\n\n/**\n * Handles when a request is successful (i.e., completed and response received).\n * Stores thhe responseText and checks if loading is complete.\n * @param {number} id The id of the request.\n * @param {goog.net.XhrIo} xhrIo The XhrIo objects that was used.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleSuccess_ = function(id, xhrIo) {\n  'use strict';\n  // Save the response text.\n  this.helper_.setResponseText(id, xhrIo.getResponseText());\n\n  // Check if all response texts have been received.\n  if (this.helper_.isLoadComplete()) {\n    this.finishLoad_();\n  }\n  xhrIo.dispose();\n};\n\n\n/**\n * Handles when a request has ended in error (i.e., all retries completed and\n * none were successful). Cancels loading of the URI's.\n * @param {number|string} id The id of the request.\n * @param {goog.net.XhrIo} xhrIo The XhrIo objects that was used.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleError_ = function(id, xhrIo) {\n  'use strict';\n  // TODO(user): Abort all pending requests.\n\n  // Dispatch the ERROR event.\n  this.dispatchEvent(new goog.net.BulkLoader.LoadErrorEvent(xhrIo.getStatus()));\n  xhrIo.dispose();\n};\n\n\n/**\n * Finishes the load of the URI's. Dispatches the SUCCESS event.\n * @private\n */\ngoog.net.BulkLoader.prototype.finishLoad_ = function() {\n  'use strict';\n  goog.log.info(this.logger_, 'All uris loaded.');\n\n  // Dispatch the SUCCESS event.\n  this.dispatchEvent(goog.net.EventType.SUCCESS);\n};\n\n\n/** @override */\ngoog.net.BulkLoader.prototype.disposeInternal = function() {\n  'use strict';\n  goog.net.BulkLoader.superClass_.disposeInternal.call(this);\n\n  this.eventHandler_.dispose();\n  this.eventHandler_ = null;\n\n  this.helper_.dispose();\n  this.helper_ = null;\n};\n\n\n/**\n * @param {number} status The response status.\n * @constructor\n * @extends {goog.events.Event}\n * @final\n * @protected\n */\ngoog.net.BulkLoader.LoadErrorEvent = function(status) {\n  'use strict';\n  goog.net.BulkLoader.LoadErrorEvent.base(\n      this, 'constructor', goog.net.EventType.ERROR);\n\n  /** @type {number} */\n  this.status = status;\n};\ngoog.inherits(goog.net.BulkLoader.LoadErrorEvent, goog.events.Event);\n"],
"names":["goog","provide","require","requireType","net","BulkLoader","goog.net.BulkLoader","uris","events","EventTarget","call","helper_","BulkLoaderHelper","eventHandler_","EventHandler","inherits","prototype","logger_","log","getLogger","getResponseTexts","goog.net.BulkLoader.prototype.getResponseTexts","getRequestUris","goog.net.BulkLoader.prototype.getRequestUris","getUris","load","goog.net.BulkLoader.prototype.load","eventHandler","info","length","i","xhrIo","XhrIo","listen","EventType","COMPLETE","bind","handleEvent_","send","goog.net.BulkLoader.prototype.handleEvent_","id","e","type","getUri","target","isSuccess","handleSuccess_","handleError_","goog.net.BulkLoader.prototype.handleSuccess_","setResponseText","getResponseText","isLoadComplete","finishLoad_","dispose","goog.net.BulkLoader.prototype.handleError_","dispatchEvent","LoadErrorEvent","getStatus","goog.net.BulkLoader.prototype.finishLoad_","SUCCESS","disposeInternal","goog.net.BulkLoader.prototype.disposeInternal","superClass_","goog.net.BulkLoader.LoadErrorEvent","status","base","ERROR","Event"]
}
